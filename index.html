<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ğŸ’œ Libro Secreto para Silvia ğŸ’œ</title>
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ’œ</text></svg>">

    <!-- CSS Externo -->
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="upload.css">
</head>

<body>
    <!-- ============ NOTIFICACIÃ“N SUPERIOR ============ -->
    <div id="top-notice">
        <span id="top-notice-text">Frase nueva para mi esposita hermosa ğŸ’•</span>
    </div>

    <!-- ============ PANTALLA DE BLOQUEO (PIN) ============ -->
    <div id="gate">
        <div class="gate-box">
            <h1 class="gate-title">ğŸ’œ Libro Secreto para Silvia ğŸ’œ</h1>
            <p class="gate-subtitle">para mi princesa hermosa Silvia ğŸ’•</p>

            <label class="pin-label">Ingresa el cÃ³digo secreto</label>
            <input type="password" id="pin" readonly maxlength="4">

            <div class="numpad">
                <button class="num-btn" data-k="1">1</button>
                <button class="num-btn" data-k="2">2</button>
                <button class="num-btn" data-k="3">3</button>
                <button class="num-btn" data-k="4">4</button>
                <button class="num-btn" data-k="5">5</button>
                <button class="num-btn" data-k="6">6</button>
                <button class="num-btn" data-k="7">7</button>
                <button class="num-btn" data-k="8">8</button>
                <button class="num-btn" data-k="9">9</button>
                <button class="num-btn" id="clear">Borr</button>
                <button class="num-btn" data-k="0">0</button>
                <button class="num-btn" id="enter">Entr</button>
            </div>

            <div id="toast"></div>
            <p class="gate-footer">Este libro se abre solo para ti âœ¨</p>
        </div>
    </div>

    <!-- ============ LIBRO PRINCIPAL ============ -->
    <div id="bookView">
        <div id="book" class="book-pages">

            <!-- ===== PÃGINA IZQUIERDA ===== -->
            <div class="page page-left">
                <div class="page-content">
                    <h2 class="book-title">Mensaje secreto</h2>
                    <p class="book-subtitle">para mi princesa hermosa Silvia ğŸ’–</p>

                    <!-- Contador de dÃ­as -->
                    <div class="day-counter">
                        <div class="number" id="days-together">2558</div>
                        <div class="label">dÃ­as juntos ğŸ’•</div>
                        <p class="phrase-day">Frase del dÃ­a 2558</p>
                    </div>

                    <!-- Frase con etiqueta de dÃ­a -->
                    <div class="phrase-container">
                        <div class="phrase-day-label">DÃ­a 52</div>
                        <p id="phrase">Cargando tu mensaje...</p>
                    </div>

                    <!-- Reacciones -->
                    <div class="reactions">
                        <p>Â¿CÃ³mo te hace sentir?</p>
                        <div class="reaction-btns">
                            <button onclick="addReaction('â¤ï¸')" class="reaction-btn">â¤ï¸</button>
                            <button onclick="addReaction('ğŸ˜')" class="reaction-btn">ğŸ˜</button>
                            <button onclick="addReaction('ğŸ¥°')" class="reaction-btn">ğŸ¥°</button>
                            <button onclick="addReaction('âœ¨')" class="reaction-btn">âœ¨</button>
                            <button onclick="addReaction('ğŸ’•')" class="reaction-btn">ğŸ’•</button>
                            <button onclick="addReaction('â˜€ï¸')" class="reaction-btn">â˜€ï¸</button>
                        </div>
                        <div id="reaction-display"></div>
                    </div>

                    <!-- Botones de acciÃ³n -->
                    <div class="book-actions">
                        <button id="more" class="btn-primary">ğŸ’• Otra frase</button>
                        <button onclick="openHistory()" class="btn-secondary">ğŸ“Š Historial</button>
                    </div>

                    <button id="lock" class="btn-danger">ğŸ”’ Cerrar libro</button>
                </div>
            </div>

            <!-- ===== PÃGINA DERECHA ===== -->
            <div class="page page-right">
                <div class="page-content">
                    <h3 class="page-title">Este libro se abre solo para ti âœ¨</h3>

                    <!-- Contador prÃ³ximo encuentro -->
                    <div class="next-meeting">
                        <div class="meeting-icon">â° PrÃ³ximo encuentro</div>
                        <div class="meeting-countdown">
                            <div class="time-box">
                                <div class="time-number" id="years-together">4</div>
                                <div class="time-label">AÃ‘OS</div>
                            </div>
                            <div class="time-box">
                                <div class="time-number" id="months-extra">10</div>
                                <div class="time-label">MESES</div>
                            </div>
                            <div class="time-box">
                                <div class="time-number" id="days-extra">16</div>
                                <div class="time-label">DÃAS</div>
                            </div>
                        </div>
                    </div>

                    <!-- Botones extras -->
                    <div class="extra-actions">
                        <button onclick="openGallery()" class="btn-extra">ğŸ“· Ver Recuerdos</button>
                        <button onclick="openUploadModal()" class="btn-extra">ğŸ“¸ Subir Foto</button>
                    </div>
                </div>

                <!-- DecoraciÃ³n flor -->
                <div class="flower-decoration">ğŸŒ¸</div>
            </div>
        </div>
    </div>

    <!-- ============ MODAL: TIEMPO DE ESPERA ============ -->
    <div id="modal">
        <div id="modalBox">
            <h3>â° PrÃ³ximo encuentro</h3>
            <p>Mi princesa Silvia ğŸ’œ, el destino te revelarÃ¡ la prÃ³xima frase dentro de</p>
            <div id="remain">12:00:00</div>
            <p>horas ğŸŒ™âœ¨</p>
            <button id="m-ok" class="btn-primary">Entendido</button>
        </div>
    </div>

    <!-- ============ MODAL: GALERÃA ============ -->
    <div id="gallery-modal" class="modal-overlay">
        <div class="gallery-content">
            <div class="gallery-header">
                <h3>ğŸ“¸ Nuestros Recuerdos ğŸ’•</h3>
                <button class="close-btn" onclick="closeGallery()">Ã—</button>
            </div>
            <div id="gallery-grid"></div>
        </div>
    </div>

    <!-- ============ MODAL: HISTORIAL ============ -->
    <div id="history-modal" class="modal-overlay">
        <div class="history-content">
            <div class="history-header">
                <h3>ğŸ“– Frases anteriores</h3>
                <button class="close-btn" onclick="closeHistory()">Ã—</button>
            </div>
            <div id="history-list"></div>
        </div>
    </div>

    <!-- ============ MODAL: SUBIR FOTO ============ -->
    <div class="upload-modal" id="upload-modal">
        <div class="upload-modal-content">
            <h2>ğŸ“· Subir Nueva Foto</h2>

            <div class="upload-input-group">
                <label>Seleccionar foto:</label>
                <input type="file" id="photo-file" accept="image/*">
            </div>

            <div class="upload-preview" id="upload-preview"></div>

            <div class="upload-input-group">
                <label>DescripciÃ³n (opcional):</label>
                <input type="text" id="photo-caption" placeholder="Ej: Nuestro dÃ­a especial">
            </div>

            <div class="upload-input-group">
                <label>Fecha:</label>
                <input type="date" id="photo-date">
            </div>

            <div class="upload-buttons">
                <button class="upload-btn-primary" onclick="uploadPhoto()">Subir</button>
                <button class="upload-btn-secondary" onclick="closeUploadModal()">Cancelar</button>
            </div>

            <div class="upload-progress" id="upload-progress">
                <div class="upload-progress-bar">
                    <div class="upload-progress-fill" id="upload-progress-fill"></div>
                </div>
                <div class="upload-status" id="upload-status">Subiendo...</div>
            </div>
        </div>
    </div>

    <!-- ============ AUDIO ============ -->
    <audio id="ding" src="https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3"></audio>

    <!-- MÃšSICA DE FONDO - Pablo AlborÃ¡n -->
    <audio id="background-music" loop preload="auto">
        <source src="Pablo Alboran - Donde EstÃ¡ El Amor ft. Jesse & Joy (Videoclip oficial).mp3" type="audio/mpeg">
    </audio>

    <!-- ============ SCRIPTS ============ -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="frases_silvia.js"></script>
    <script src="app.js"></script>
</body>

</html>